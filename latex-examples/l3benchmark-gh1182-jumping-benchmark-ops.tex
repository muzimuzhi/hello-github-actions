\documentclass{article}
\usepackage{array}
\usepackage{l3benchmark}

\ExplSyntaxOn
\cs_gset_protected:Npn \benchmark_silent:n #1
  {
    \__benchmark_measure_op:
    \tl_gset:Nn \g__benchmark_code_tl {#1}
    \__benchmark_aux:
    \fp_gset:Nn \g_benchmark_ops_fp { \g_benchmark_time_fp / \g__benchmark_one_op_fp }
    % debug note: sometimes \g__benchmark_one_op_fp == 1e-16
%    \iow_term:x
%      {
%        [debug]~
%        ops~ =~ time~ /~ one_op,~
%        \__benchmark_fp_to_tl:N \g_benchmark_ops_fp~ =~
%        \__benchmark_fp_to_tl:N \g_benchmark_time_fp~ /~
%        \__benchmark_fp_to_tl:N \g__benchmark_one_op_fp
%      }
  }

\cs_gset_protected:Npn \__benchmark_measure_op:
  {
    \int_gset:Nn \g__benchmark_duration_int
      { \fp_to_int:n { 65536 * \g_benchmark_duration_target_fp } / 4 }
    \tl_gset:Nn \g__benchmark_code_tl
      { \int_gadd:Nn \g__benchmark_duration_int { 0 } }
    \__benchmark_aux:
    \fp_gset:Nn \g__benchmark_one_op_fp { max(\g_benchmark_time_fp, 1e-16) }
    % debug note: sometimes \g_benchmark_time_fp == 0
    \iow_term:x
      {
        [debug]~
        time~ =~ \fp_to_tl:N \g_benchmark_time_fp ,~
        one_op~ = \fp_to_tl:N \g__benchmark_one_op_fp
      }
    \int_gset:Nn \g__benchmark_duration_int
      { \fp_to_int:n { 65536 * \g_benchmark_duration_target_fp } }
  }

\cs_gset_protected:Npn \__benchmark_raw_end:N #1
  {
    \int_gset:Nn #1
      {
        \sys_timer: -
        \int_use:c { g__benchmark_ \int_use:N \g__benchmark_nesting_int _int }
      }
    \iow_term:x
      {
        [debug]~
        start~ =~ \int_use:c { g__benchmark_ \int_use:N \g__benchmark_nesting_int _int } ,~
        diff~  =~ \int_use:N #1
      }
    \int_gdecr:N \g__benchmark_nesting_int
  }


\cs_new_protected:Npn \runtest #1 #2
  {
    #2 %% run the code first to load fonts
    \prg_replicate:nn { #1 }
      {
        \benchmark:n { #2 }
        % \fp_log:N \g_benchmark_time_fp
        % \fp_log:N \g_benchmark_ops_fp
      }
  }
\ExplSyntaxOff

\begin{document}

\newcommand\testcode{%
  \begin{tabular}{|l|c|r|p{4em}|m{4em}|b{4em}|}
  \hline
    alpha & beta    & gamma   & delta & epsilon & zeta  \\
  \hline
    eta   & theta   & iota    & kappa & lambda  & mu    \\
  \hline
    nu    & xi      & omicron & pi    & rho     & sigma \\
  \hline
    tau   & upsilon & phi     & chi   & psi     & omega \\
  \hline
  \end{tabular}\par
}

\runtest{20}{\testcode}

\end{document}
