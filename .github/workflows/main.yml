name: Unzip in powershell
on: 
  push:
    branches-ignore:
      - 'self/**'
    paths:
      - '.github/workflows/main.yml'
  pull_request:
    paths:
      - '.github/workflows/main.yml'
  workflow_dispatch:

jobs:
  build-windows:
    runs-on: windows-latest
    steps:
      # - uses: actions/checkout@v4

      - name: Install TeX Live
        uses: teatimeguest/setup-texlive-action@v3
        with:
          packages: amsmath

      - name: Play with texlive bin dir
        shell: C:\msys64\usr\bin\bash.exe -e {0}
        run: |
          # paths joined by ":"
          # $PATH already starts with "/d/a/_temp/setup-texlive-action/2023/bin/windows:"
          echo $PATH
          # ah, runner.temp is in win style, but msys2bash uses a unix style
          ls /d/a/_temp/setup-texlive-action/2023/bin/windows
          which unzip

      - name: Install Noto fonts
        # see https://github.com/texstudio-org/texstudio/blob/master/.github/workflows/cd.yml
        shell: C:\msys64\usr\bin\bash.exe -e {0}
        run: |
          curl -Lo NotoSansCJK-OTC.zip ${{ env.NOTO_SANS_URL }}
          curl -Lo NotoSerifCJK-OTC.zip ${{ env.NOTO_SERIF_URL }}
          where unzip
          echo ""
          unzip -l NotoSansCJK-OTC.zip
          unzip -ojd . NotoSansCJK-OTC.zip "**Sans*.ttc"
          echo ""
          unzip -l NotoSerifCJK-OTC.zip
          unzip -ojd . NotoSerifCJK-OTC.zip "**Serif*.ttc"
        env:
          NOTO_SANS_URL: https://github.com/googlefonts/noto-cjk/releases/download/Sans2.004/03_NotoSansCJK-OTC.zip
          NOTO_SERIF_URL: https://github.com/googlefonts/noto-cjk/releases/download/Serif2.001/04_NotoSerifCJKOTC.zip
